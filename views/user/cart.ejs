<%- include('../layouts/user/userHeader.ejs') %>


<body>

    <div class="main-wrapper">
        <header class="header-area section-padding-1">
            <div class="container-fluid">
                <div class="row align-items-center">
                    <!-- Left side with Home and Shop -->
                    <div class="col-xl-4 col-lg-4 d-flex justify-content-start">
                        <div class="main-menu menu-lh-1 main-menu-padding-1">
                            <nav>
                                <ul class="d-flex">
                                    <li><a href="/">Home</a></li>
                                    <li><a href="/shop">Shop</a></li>
                                </ul>
                            </nav>
                        </div>
                    </div>
        
                    <!-- Centered Logo -->
                    <div class="col-xl-4 col-lg-4 d-flex justify-content-center">
                        <div class="logo logo-width">
                            <a href="/">
                                <img src="user/assets/images/logo/logo.png" alt="logo">
                            </a>
                        </div>
                    </div>
        
                    <!-- Right side with Wishlist, Cart, Search, and Account -->
                    <div class="col-xl-4 col-lg-4 d-flex justify-content-end">
                        <div class="header-right-wrap header-right-flex">
                            <div class="same-style header-wishlist">
                                <a href="/wishlist"><i class="far fa-heart"></i></a>
                            </div>
                            <div class="same-style cart-wrap">
                                <a href="/cart" class="cart-active">
                                    <i class="dlicon shopping_bag-20"></i>
                                    <span class="count-style"><%= cartcount  %></span>
                                </a>
                            </div>
                            <div class="same-style header-search">
                                <a class="search-active" href="#"><i class="dlicon ui-1_zoom"></i></a>
                            </div>
                            <div class="same-style header-off-canvas">
                                <a href="/login">
                                    <i class="far fa-user" style="font-size: 20px; color: black;" onmouseover="this.style.color='red'" onmouseout="this.style.color='black'"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <div class="header-small-mobile section-padding-1">
            <div class="container-fluid">
                <div class="row align-items-center">
                    <div class="col-6">
                        <div class="mobile-logo logo-width">
                            <a href="index.html">
                                <img alt="" src="user/assets/images/logo/logo.png">
                            </a>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="mobile-header-right-wrap">
                            <div class="header-right-wrap header-right-flex">
                                <div class="same-style cart-wrap">
                                    <a href="/cart" class="cart-active">
                                        <i class="dlicon shopping_bag-20"></i>
                                        <span class="count-style"><%= cartcount  %></span>
                                    </a>
                                </div>
                                <div class="same-style header-off-canvas">
                                    <a class="header-aside-button" href="#">
                                        <i class="dlicon ui-3_menu-left"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- search start -->
        <div class="search-content-wrap main-search-active">
            <a  class="search-close"><i  class="dlicon ui-1_simple-remove"></i></a>
            <div class="search-content">
                <p>Start typing and press Enter to search</p>
                <form class="search-form" action="#">
                    <input type="text" placeholder="Search">
                    <button class="button-search"><i class="dlicon ui-1_zoom"></i></button>
                </form>
            </div>
        </div>
       
        <!-- aside start -->
        <div class="header-aside-active">
            <div class="header-aside-wrap">
                <a class="aside-close"><i class="dlicon ui-1_simple-remove"></i></a>
                <div class="header-aside-content">
                    <div class="mobile-menu-area">
                        <div class="mobile-search">
                            <form class="search-form" action="#">
                                <input type="text" placeholder="Search entire store…">
                                <button class="button-search"><i class="dlicon ui-1_zoom"></i></button>
                            </form>
                        </div>
                        <div class="mobile-menu-wrap">
                            <!-- mobile menu start -->
                            <div class="mobile-navigation">
                              
                                
                               
                            </div>
                            <!-- mobile menu end -->
                        </div>
                        <div class="mobile-curr-lang-wrap">
                            <div class="single-mobile-curr-lang">
                                <a class="mobile-language-active" href="#">Language <i class="fa fa-angle-down"></i></a>
                                <div class="lang-curr-dropdown lang-dropdown-active">
                                    <ul>
                                        <li><a href="#">English (US)</a></li>
                                        <li><a href="#">English (UK)</a></li>
                                        <li><a href="#">Spanish</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="single-mobile-curr-lang">
                                <a class="mobile-currency-active" href="#">Currency <i class="fa fa-angle-down"></i></a>
                                <div class="lang-curr-dropdown curr-dropdown-active">
                                    <ul>
                                        <li><a href="#">USD</a></li>
                                        <li><a href="#">EUR</a></li>
                                        <li><a href="#">Real</a></li>
                                        <li><a href="#">BDT</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="single-mobile-curr-lang">
                                <a class="mobile-account-active" href="#">My Account <i class="fa fa-angle-down"></i></a>
                                <div class="lang-curr-dropdown account-dropdown-active">
                                    <ul>
                                        <li><a href="#">Login</a></li>
                                        <li><a href="#">Creat Account</a></li>
                                        <li><a href="my-account.html">My Account</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="header-aside-menu">
                        <nav>
                            <ul>
                                <li><a href="#">About Toro</a></li>
                                <li><a href="#">Help Center</a></li>
                                <li><a href="#">Collection</a></li>
                                <li><a href="#">Blog</a></li>
                                <li><a href="#">New Look</a></li>
                            </ul>
                        </nav>
                    </div>
                    <img src="user/assets/images/icon-img/payments.png" alt="payment">
                    <p>Pellentesque mollis nec orci id tincidunt. Sed mollis risus eu nisi aliquet, sit amet fermentum justo dapibus.</p>
                    <div class="aside-contact-info">
                        <ul>
                            <li><i class="dlicon ui-2_time-clock"></i>Monday - Friday: 9:00 - 19:00</li>
                            <li><i class="dlicon ui-1_email-84"></i>Info@la-studioweb.com</li>
                            <li><i class="dlicon tech-2_rotate"></i>(+55) 254. 254. 254</li>
                            <li><i class="dlicon ui-1_home-minimal"></i>Helios Tower 75 Tam Trinh Hoang - Ha Noi - Viet Nam</li>
                        </ul>
                    </div>
                    <div class="social-icon-style mb-25">
                        <a class="facebook" href="#"><i class="fa fa-facebook"></i></a>
                        <a class="twitter" href="#"><i class="fa fa-twitter"></i></a>
                        <a class="google-plus" href="#"><i class="fa fa-google-plus"></i></a>
                        <a class="behance" href="#"><i class="fa fa-behance"></i></a>
                    </div>
                    <div class="copyright">
                        <p>© 2021 <a href="https://hasthemes.com/">Toro.</a> All rights reserved</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="breadcrumb-area section-padding-1 bg-gray breadcrumb-ptb-1">
            <div class="container-fluid">
                <div class="breadcrumb-content text-center">
                    <div class="breadcrumb-title">
                        <h2>Shopping Cart</h2>
                    </div>
                    <ul>
                        <li>
                            <a href="/">Home </a>
                        </li>
                        <li><span> &gt; </span></li>
                        <li class="active"> Shopping Cart </li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- cart start -->
        <div class="cart-main-area pt-90 pb-100">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-12">
                        <form action="#">
                            <% if(cart && cart.products.length > 0) { %>
                            <div class="row">
                                <div class="col-lg-8">
                                    <div class="table-content table-responsive cart-table-content">
                                        
                                        <table>
                                            <thead>
                                                <tr>
                                                    <th></th>
                                                    <th></th>
                                                    <th>Product</th>
                                                    <th>Price</th>
                                                    <th>Quantity</th>
                                                    <th>Total</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                    <% cart.products.forEach((e, i) => { %>
                                                        <tr id="cartItem_<%= i %>">
                                                            <td class="product-remove">
                                                                <a onclick="remove('<%= e.productId._id %>', '<%= i %>')">
                                                                    <i class="dlicon ui-1_simple-remove"></i>
                                                                </a>
                                                            </td>
                                                            <td class="product-img">
                                                                <a href="#"><img src="<%= e.productId.image[0] %>" alt="" class="small-img"></a>
                                                            </td>
                                                            <td class="product-name" style="transform: translate(2.5rem);">
                                                                <a href="#"><p><%= e.productId.name %></p></a>
                                                            </td>
                                                            <td class="product-price">
                                                                <span class="amount">
                                                                    ₹<%= e.productId.offer ? Math.floor(e.productId.offerPrice) : Math.floor(e.productId.price) %>
                                                                    <% if(e.productId.offer) { %>
                                                                        <span class="original-price" style="text-decoration: line-through; color: grey;">
                                                                            ₹<%= e.productId.price %>
                                                                        </span>
                                                                    <% } %>
                                                                </span>
                                                            </td>
                                                            <td class="cart-quantity">
                                                                <div style="padding: 0 .5rem;" class="product-details-quantity quantity-width-cart">
                                                                    <div style="cursor: pointer; display: flex; align-items: center; position: relative;">
                                                                        <i onclick="plus(this, '<%= e.productId.stock %>', '<%= e.productId._id %>')" class="ri-add-line" style="position: absolute; left: 0.2rem;"></i>
                                                                        <input class="cart-plus-minus-box" style="cursor: text; text-align: center;" type="text" name="qtybutton" value="<%= e.count %>" data-price="<%= e.productId.offer ? e.productId.offerPrice : e.productId.price %>">
                                                                        <i onclick="minus(this, '<%= e.productId._id %>')" class="ri-subtract-line" style="position: absolute; left: 85%;"></i>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                            <td class="product-total">
                                                                <span>₹<%= (e.productId.offer ? Math.floor(e.productId.offerPrice) : Math.floor(e.productId.price) * e.count) %></span>
                                                            </td>
                                                        </tr>
                                                        <% }); %>
                                                    </tbody>
                                                </table>
                                        
                                    </div>
                                    <div class="cart-shiping-update-wrapper">
                                        <div class="discount-code">
                                         
                                        </div>
                                        <!-- <div class="cart-clear">
                                            <a href="#">Clear Cart</a>
                                        
                                        </div> -->
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="grand-total-wrap">
                                        <h4>Cart totals</h4>
                                        <div class="grand-total-content">
                                            <ul>
                                                <li>Subtotal <span id="cart-subtotal">₹0.00</span></li>
                                                <li>Total <span id="cart-total">₹0.00</span></li>
                                            </ul>
                                        </div>
                                        
                                        <div class="grand-btn">
                                            <% if(locals.cart.products?.length > 0) { %>
                                                <a href="/checkout?total=<span id='cart-total'></span>">Proceed to checkout</a>
                                                <% } %>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                               
                            <% } else { %>
                                <h2 style="padding-left:28rem;">Nothing in the cart</h2>
                            <% } %>
                            </form>
                    </div>
                </div>
            </div>
        </div>
        <!-- cart end -->
        <footer class="footer-area bg-black section-padding-1">
            <div class="container-fluid">
                <div class="footer-top pt-95 pb-80">
                    <div class="row">
                        <!-- Footer Column: Logo -->
                        <div class="col-12 text-center">
                            <div class="logo logo-res-center">
                                <a href="index.html">
                                    <img src="user/assets/images/logo/logo-white.png" alt="logo">
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="footer-bottom pb-15">
                    <div class="row">
                        <div class="col-12">
                            <div class="copyright text-center">
                                <p>© 2024 <a href="https://hasthemes.com/">Toro.</a> All rights reserved.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
     
     
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.7.2/axios.min.js" integrity="sha512-JSCFHhKDilTRRXe9ak/FJ28dcpOJxzQaCd3Xg8MyF6XFjODhy/YMCM8HW0TFDckNHWUewW+kfvhin43hKtJxAw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <!-- All JS is here
============================================ -->

<script>
    async function remove(id, index) {
    const swalWithBootstrapButtons = Swal.mixin({
        customClass: {
            confirmButton: "btn btn-success",
            cancelButton: "btn btn-danger"
        },
        buttonsStyling: false
    });

    try {
        const result = await swalWithBootstrapButtons.fire({
            title: "Are you sure?",
            text: "You won't be able to revert this!",
            icon: "warning",
            showCancelButton: true,
            confirmButtonText: "Yes, delete it!",
            cancelButtonText: "No, cancel!",
            reverseButtons: true
        });

        if (result.isConfirmed) {
            await axios.post('/remove', {  id });

            document.getElementById(`cartItem_${index}`).remove();

            swalWithBootstrapButtons.fire({
                title: "Deleted!",
                text: "Your product has been removed from the cart.",
                icon: "success"
            });
        } else if (result.dismiss === Swal.DismissReason.cancel) {
            swalWithBootstrapButtons.fire({
                title: "Cancelled",
                text: "Your product is safe :)",
                icon: "error"
            });
        }
    } catch (error) {
        console.error('Error removing product from cart:', error);
        swalWithBootstrapButtons.fire({
            title: "Error!",
            text: "Failed to remove product from cart",
            icon: "error"
        });
    }
}

</script>

<script>
    async function plus(e, qt, proID) {
        const g = e.nextElementSibling;
        if (qt > Number(g.value)) {
            g.value = Number(g.value) + 1;
        } else {
            g.value = qt;
        }
        updateTotal(e);
        await cartUpdate(proID, g.value);
    }

    async function minus(e, proID) {
        const g = e.previousElementSibling;
        if (Number(g.value) > 1) {
            g.value = Number(g.value) - 1;
        }
        updateTotal(e);
        await cartUpdate(proID, g.value);
    }

    async function cartUpdate(proID, qt) {
        try {
            await axios.post('/cartupdate', { productId: proID, count: qt });
        } catch (error) {
            console.error('Error updating cart:', error);
        }
    }

    function updateTotal(e) {
        const row = e.closest('tr');
        const quantity = parseInt(row.querySelector('.cart-plus-minus-box').value, 10);
        const price = parseInt(row.querySelector('.cart-plus-minus-box').dataset.price, 10);
        const totalElement = row.querySelector('.product-total span');
        totalElement.textContent = '₹' + (price * quantity).toFixed(2);

        updateCartSummary();
    }

    document.addEventListener('DOMContentLoaded', () => {
        updateCartSummary();
    });

    function updateCartSummary() {
        let subtotal = 0;
        document.querySelectorAll('.product-total span').forEach(item => {
            subtotal += parseInt(item.textContent.replace('₹', ''), 10);
        });

        const total = subtotal; // Adjust if there are additional charges or discounts
        document.getElementById('cart-subtotal').textContent = '₹' + subtotal.toFixed(2);
        document.getElementById('cart-total').textContent = '₹' + total.toFixed(2);
    }
</script>

<style>
    .small-img {
    width: 100px;
    height: 100px;
}

</style>

    <!-- Modernizer JS -->
    <script src="user/assets/js/vendor/modernizr-3.11.7.min.js"></script>
    <!-- jquery -->
    <script src="user/assets/js/vendor/jquery-v3.6.0.min.js"></script>
    <!-- Popper JS -->
    <script src="user/assets/js/vendor/popper.js"></script>
    <!-- Bootstrap JS -->
    <script src="user/assets/js/vendor/bootstrap.min.js"></script>
    <script src="user/assets/js/plugins/owl-carousel.js"></script>
    <script src="user/assets/js/plugins/slick.js"></script>
    <script src="user/assets/js/plugins/jarallax.min.js"></script>
    <script src="user/assets/js/plugins/countdown.js"></script>
    <script src="user/assets/js/plugins/magnific-popup.js"></script>
    <script src="user/assets/js/plugins/instafeed.js"></script>
    <script src="user/assets/js/plugins/tilt.js"></script>
    <script src="user/assets/js/plugins/images-loaded.js"></script>
    <script src="user/assets/js/plugins/isotope.js"></script>
    <script src="user/assets/js/plugins/scrolloverflow-fullpage.js"></script>
    <script src="user/assets/js/plugins/fullpage.js"></script>
    <script src="user/assets/js/plugins/jquery-ui.js"></script>
    <script src="user/assets/js/plugins/jquery-ui-touch-punch.js"></script>
    <script src="user/assets/js/plugins/easyzoom.js"></script>
    <script src="user/assets/js/plugins/resizesensor.js"></script>
    <script src="user/assets/js/plugins/sticky-sidebar.js"></script>
    <script src="user/assets/js/plugins/scrollup.js"></script>
    <script src="user/assets/js/plugins/select2.min.js"></script>
    <script src="user/assets/js/plugins/cookie.js"></script>
    <script src="user/assets/js/plugins/bpopup.js"></script>
    <script src="user/assets/js/plugins/wow.js"></script>
    <script src="user/assets/js/plugins/ajax-mail.js"></script>
    <!-- Main JS -->
    <script src="user/assets/js/main.js"></script>

</body>


<!-- Mirrored from htmldemo.net/toro/toro/cart.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 22 Feb 2024 11:04:57 GMT -->
</html>